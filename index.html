<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="tarot-images.js"></script>
    <link rel="stylesheet" href="style.css">
    <title>Authentic Tarot</title>
</head>
<body>
    <h1 id="header">Keep tapping screen until cards appear! This shuffles the deck</h1>
    <div class="container" id="container"></div>
</body>
<script>
    var tarotDeck = JSON.parse(tarotImages);
    var numCards = 78;
    var index = 0;
    const header = document.getElementById("header");
    const container = document.getElementById("container");
    const startTime = Date.now();

    function getCardIndex(x, y) {
        var endTime = Date.now();
        var rand = x + y + endTime - startTime;
        var cardIndex = Math.floor(rand % numCards);
        var cardName = tarotDeck.cards[cardIndex].name;
        var cardImage = tarotDeck.cards[cardIndex].img;
        var card = document.createElement("div");
        card.setAttribute("class", "card");
        card.setAttribute("id", index);
        card.setAttribute("data-index", cardIndex);
        card.setAttribute("data-name", cardName)
        card.setAttribute("image-path", cardImage);
        card.setAttribute("onclick", "reveal(" + index  + ")");
        container.appendChild(card);
        tarotDeck.cards.splice(cardIndex, 1);
        numCards--;
        index++;
    }

    function showCards() {
        container.style.setProperty("display", "initial");
        header.innerText = "Tap/click a card to reveal it";
    };

    function reveal(index) {
        var card = document.getElementById(index);
        card.title = card.getAttribute("data-name");
        var imagePath = card.getAttribute("image-path");
        card.style.setProperty("background-image", `url(\"cards/${imagePath}\")`);
    }

    function shuffle(event) {
        var x = event.clientX;
        var y = event.clientY;
        if (numCards > 0) {
            getCardIndex(x, y);
            percentDone = Math.floor((100 - (numCards / 78 * 100)));
            header.innerText = percentDone + "% done"
        }
        else {
            showCards();
            document.removeEventListener('click', shuffle);
        }
    }

    document.addEventListener('click', shuffle);
</script>
</html>
